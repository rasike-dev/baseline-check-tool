<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baseline Compatibility Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 20px;
        }

        .report-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .meta-item {
            text-align: center;
            padding: 15px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
        }

        .meta-item .label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }

        .meta-item .value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-5px);
        }

        .summary-card .icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .summary-card .title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .summary-card .value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .summary-card .subtitle {
            font-size: 0.9rem;
            color: #666;
        }

        .status-baseline { color: #10b981; }
        .status-risky { color: #f59e0b; }
        .status-unknown { color: #6b7280; }
        .status-critical { color: #dc2626; }

        .charts-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .chart-container h3 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }

        .chart {
            min-height: 200px;
            position: relative;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .bar-label {
            min-width: 120px;
            font-weight: 500;
        }

        .bar-track {
            flex: 1;
            height: 25px;
            background: #e5e7eb;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .bar-fill {
            height: 100%;
            border-radius: 12px;
            transition: width 0.8s ease;
            position: relative;
        }

        .bar-value {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .features-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-group label {
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
        }

        .control-group input,
        .control-group select {
            padding: 8px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }

        .control-group input:focus,
        .control-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .features-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .features-table th {
            background: #f8fafc;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.3s ease;
        }

        .features-table th:hover {
            background: #f1f5f9;
        }

        .features-table td {
            padding: 15px;
            border-bottom: 1px solid #e5e7eb;
            vertical-align: top;
        }

        .features-table tr:hover {
            background: #f8fafc;
        }

        .feature-name {
            font-weight: 600;
            color: #1f2937;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-baseline {
            background: #d1fae5;
            color: #065f46;
        }

        .status-risky {
            background: #fef3c7;
            color: #92400e;
        }

        .status-unknown {
            background: #f3f4f6;
            color: #374151;
        }

        .status-critical {
            background: #fee2e2;
            color: #991b1b;
        }

        .usage-count {
            font-weight: bold;
            color: #667eea;
        }

        .files-list {
            max-width: 200px;
        }

        .file-item {
            background: #f8fafc;
            padding: 4px 8px;
            margin: 2px 0;
            border-radius: 4px;
            font-size: 0.8rem;
            color: #4b5563;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .browser-support {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .browser-icon {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
        }

        .browser-chrome { background: #4285f4; }
        .browser-firefox { background: #ff9500; }
        .browser-safari { background: #007aff; }
        .browser-edge { background: #0078d4; }

        .recommendations {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .recommendation-item {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .recommendation-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 8px;
        }

        .recommendation-description {
            color: #4b5563;
            margin-bottom: 10px;
        }

        .recommendation-actions {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .recommendation-actions h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .recommendation-actions ul {
            list-style: none;
            padding: 0;
        }

        .recommendation-actions li {
            padding: 4px 0;
            color: #4b5563;
            font-size: 0.9rem;
        }

        .recommendation-actions li:before {
            content: "‚Ä¢";
            color: #667eea;
            font-weight: bold;
            margin-right: 8px;
        }

        .footer {
            text-align: center;
            padding: 30px;
            color: white;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: white;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #fee2e2;
            color: #991b1b;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .summary-cards {
                grid-template-columns: 1fr;
            }
            
            .charts-section {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .features-table {
                font-size: 0.9rem;
            }
            
            .features-table th,
            .features-table td {
                padding: 10px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Baseline Compatibility Report</h1>
            <p class="subtitle">Comprehensive analysis of web compatibility, performance, and security</p>
            
            <div class="report-meta">
                <div class="meta-item">
                    <div class="label">Generated</div>
                    <div class="value" id="generatedDate">Loading...</div>
                </div>
                <div class="meta-item">
                    <div class="label">Tool Version</div>
                    <div class="value" id="toolVersion">Loading...</div>
                </div>
                <div class="meta-item">
                    <div class="label">Analysis Duration</div>
                    <div class="value" id="analysisDuration">Loading...</div>
                </div>
                <div class="meta-item">
                    <div class="label">Files Analyzed</div>
                    <div class="value" id="filesAnalyzed">Loading...</div>
                </div>
            </div>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Loading enhanced report...</p>
        </div>

        <div id="content" style="display: none;">
            <!-- Summary Cards -->
            <div class="summary-cards">
                <div class="summary-card">
                    <div class="icon">‚úÖ</div>
                    <div class="title">Baseline Features</div>
                    <div class="value status-baseline" id="baselineCount">0</div>
                    <div class="subtitle">Safe to use</div>
                </div>
                <div class="summary-card">
                    <div class="icon">‚ö†Ô∏è</div>
                    <div class="title">Risky Features</div>
                    <div class="value status-risky" id="riskyCount">0</div>
                    <div class="subtitle">Need attention</div>
                </div>
                <div class="summary-card">
                    <div class="icon">‚ùì</div>
                    <div class="title">Unknown Features</div>
                    <div class="value status-unknown" id="unknownCount">0</div>
                    <div class="subtitle">Require research</div>
                </div>
                <div class="summary-card">
                    <div class="icon">üìä</div>
                    <div class="title">Total Features</div>
                    <div class="value" id="totalCount">0</div>
                    <div class="subtitle">Analyzed</div>
                </div>
                <div class="summary-card">
                    <div class="icon">üéØ</div>
                    <div class="title">Compatibility Score</div>
                    <div class="value" id="compatibilityScore">0%</div>
                    <div class="subtitle">Overall rating</div>
                </div>
                <div class="summary-card">
                    <div class="icon">‚ö°</div>
                    <div class="title">Performance Score</div>
                    <div class="value" id="performanceScore">0%</div>
                    <div class="subtitle">Speed & efficiency</div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-container">
                    <h3>üìä Features by Status</h3>
                    <div class="chart">
                        <div class="bar-chart" id="statusChart"></div>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>üåê Browser Support Overview</h3>
                    <div class="chart">
                        <div class="bar-chart" id="browserChart"></div>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>üìÅ Features by File Type</h3>
                    <div class="chart">
                        <div class="bar-chart" id="fileTypeChart"></div>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>üîß Feature Categories</h3>
                    <div class="chart">
                        <div class="bar-chart" id="categoryChart"></div>
                    </div>
                </div>
            </div>

            <!-- Features Section -->
            <div class="features-section">
                <div class="section-header">
                    <h2 class="section-title">üîç Detailed Feature Analysis</h2>
                    <div class="controls">
                        <div class="control-group">
                            <label for="search">Search Features</label>
                            <input type="text" id="search" placeholder="Type to search...">
                        </div>
                        <div class="control-group">
                            <label for="statusFilter">Filter by Status</label>
                            <select id="statusFilter">
                                <option value="">All Status</option>
                                <option value="baseline">Baseline</option>
                                <option value="risky">Risky</option>
                                <option value="unknown">Unknown</option>
                                <option value="critical">Critical</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label for="sortBy">Sort By</label>
                            <select id="sortBy">
                                <option value="feature">Feature Name</option>
                                <option value="status">Status</option>
                                <option value="usage">Usage Count</option>
                                <option value="browser">Browser Support</option>
                            </select>
                        </div>
                    </div>
                </div>

                <table class="features-table" id="featuresTable">
                    <thead>
                        <tr>
                            <th data-sort="feature">Feature</th>
                            <th data-sort="status">Status</th>
                            <th data-sort="usage">Usage</th>
                            <th data-sort="browser">Browser Support</th>
                            <th>Files</th>
                            <th>Recommendations</th>
                        </tr>
                    </thead>
                    <tbody id="featuresTableBody"></tbody>
                </table>
            </div>

            <!-- Recommendations Section -->
            <div class="recommendations">
                <h2 class="section-title">üí° Smart Recommendations</h2>
                <div id="recommendationsList"></div>
            </div>

            <!-- Footer -->
            <div class="footer">
                <h3>üöÄ Baseline Check Tool</h3>
                <p>Comprehensive web compatibility analysis with AI-powered insights</p>
                <p>Generated on <span id="footerDate"></span> | <a href="https://github.com/rasike-a/baseline-check" target="_blank">GitHub Repository</a></p>
            </div>
        </div>
    </div>

    <script>
        class BaselineReport {
            constructor() {
                this.data = null;
                this.filteredData = [];
                this.sortColumn = 'feature';
                this.sortDirection = 'asc';
                this.init();
            }

            async init() {
                try {
                    this.showLoading();
                    await this.loadData();
                    this.setupEventListeners();
                    this.render();
                } catch (error) {
                    this.showError(error);
                }
            }

            async loadData() {
                // Try to load from baseline-report.json first, fallback to sample data
                try {
                    const response = await fetch("./baseline-report.json");
                    if (response.ok) {
                        this.data = await response.json();
                    } else {
                        throw new Error('Report file not found');
                    }
                } catch (error) {
                    console.log('Loading sample data...');
                    this.data = this.generateSampleData();
                }
                
                this.filteredData = this.data.results || [];
            }

            generateSampleData() {
                return {
                    timestamp: new Date().toISOString(),
                    version: "2.3.0",
                    summary: {
                        totalFiles: 15,
                        totalFeatures: 42,
                        baselineFeatures: 28,
                        riskyFeatures: 10,
                        unknownFeatures: 4,
                        criticalFeatures: 2,
                        compatibilityScore: 85,
                        performanceScore: 78,
                        analysisDuration: "2.3s",
                        byStatus: {
                            baseline: 28,
                            risky: 10,
                            unknown: 4,
                            critical: 2
                        },
                        byCategory: {
                            'CSS': 12,
                            'JavaScript': 18,
                            'HTML': 8,
                            'Web APIs': 4
                        },
                        byFileType: {
                            '.html': 5,
                            '.css': 8,
                            '.js': 12,
                            '.ts': 3
                        },
                        browserSupport: {
                            'Chrome': 95,
                            'Firefox': 88,
                            'Safari': 92,
                            'Edge': 90
                        }
                    },
                    results: [
                        {
                            feature: 'CSS Grid',
                            status: 'baseline',
                            count: 8,
                            files: ['styles.css', 'layout.css', 'grid.css'],
                            browserSupport: { chrome: 57, firefox: 52, safari: 10.1, edge: 16 },
                            category: 'CSS',
                            recommendations: [
                                'Continue using CSS Grid - excellent browser support',
                                'Consider fallback for very old browsers if needed'
                            ]
                        },
                        {
                            feature: 'Flexbox',
                            status: 'baseline',
                            count: 12,
                            files: ['styles.css', 'components.css'],
                            browserSupport: { chrome: 29, firefox: 28, safari: 9, edge: 12 },
                            category: 'CSS',
                            recommendations: [
                                'Flexbox is fully supported across all modern browsers',
                                'No additional polyfills needed'
                            ]
                        },
                        {
                            feature: 'Fetch API',
                            status: 'risky',
                            count: 5,
                            files: ['api.js', 'data.js'],
                            browserSupport: { chrome: 42, firefox: 39, safari: 10.1, edge: 14 },
                            category: 'Web APIs',
                            recommendations: [
                                'Add polyfill for IE support',
                                'Consider XMLHttpRequest fallback',
                                'Test thoroughly in target browsers'
                            ]
                        },
                        {
                            feature: 'Async/Await',
                            status: 'risky',
                            count: 7,
                            files: ['utils.js', 'api.js'],
                            browserSupport: { chrome: 55, firefox: 52, safari: 10.1, edge: 14 },
                            category: 'JavaScript',
                            recommendations: [
                                'Add Babel transpilation for older browsers',
                                'Consider Promise-based alternatives',
                                'Use feature detection before using'
                            ]
                        },
                        {
                            feature: 'CSS Custom Properties',
                            status: 'baseline',
                            count: 15,
                            files: ['theme.css', 'variables.css'],
                            browserSupport: { chrome: 49, firefox: 31, safari: 9.1, edge: 16 },
                            category: 'CSS',
                            recommendations: [
                                'CSS Custom Properties have excellent modern browser support',
                                'Consider fallback values for older browsers'
                            ]
                        },
                        {
                            feature: 'Intersection Observer',
                            status: 'risky',
                            count: 3,
                            files: ['scroll.js'],
                            browserSupport: { chrome: 51, firefox: 55, safari: 12.1, edge: 15 },
                            category: 'Web APIs',
                            recommendations: [
                                'Add polyfill for older browsers',
                                'Consider scroll event fallback',
                                'Test performance impact'
                            ]
                        },
                        {
                            feature: 'Service Workers',
                            status: 'unknown',
                            count: 2,
                            files: ['sw.js'],
                            browserSupport: { chrome: 40, firefox: 44, safari: 11.1, edge: 17 },
                            category: 'Web APIs',
                            recommendations: [
                                'Research Service Worker support requirements',
                                'Consider progressive enhancement',
                                'Test in target browsers'
                            ]
                        },
                        {
                            feature: 'Web Components',
                            status: 'critical',
                            count: 1,
                            files: ['components.js'],
                            browserSupport: { chrome: 54, firefox: 63, safari: 10.1, edge: 79 },
                            category: 'Web APIs',
                            recommendations: [
                                'Web Components have limited support - consider alternatives',
                                'Add polyfills for broader compatibility',
                                'Consider React/Vue components instead'
                            ]
                        }
                    ]
                };
            }

            setupEventListeners() {
                document.getElementById('search').addEventListener('input', (e) => {
                    this.filterData(e.target.value);
                });

                document.getElementById('statusFilter').addEventListener('change', (e) => {
                    this.filterData(document.getElementById('search').value, e.target.value);
                });

                document.getElementById('sortBy').addEventListener('change', (e) => {
                    this.sortColumn = e.target.value;
                    this.sortData();
                    this.renderTable();
                });

                document.querySelectorAll('th[data-sort]').forEach(th => {
                    th.addEventListener('click', () => {
                        const column = th.dataset.sort;
                        if (this.sortColumn === column) {
                            this.sortDirection = this.sortDirection === 'asc' ? 'desc' : 'asc';
                        } else {
                            this.sortColumn = column;
                            this.sortDirection = 'asc';
                        }
                        this.sortData();
                        this.renderTable();
                        this.updateSortIndicators();
                    });
                });
            }

            filterData(searchTerm = '', statusFilter = '') {
                this.filteredData = (this.data.results || []).filter(item => {
                    const matchesSearch = item.feature.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                        item.category.toLowerCase().includes(searchTerm.toLowerCase());
                    const matchesStatus = !statusFilter || item.status === statusFilter;
                    return matchesSearch && matchesStatus;
                });
                this.renderTable();
            }

            sortData() {
                this.filteredData.sort((a, b) => {
                    let aVal, bVal;
                    
                    switch (this.sortColumn) {
                        case 'feature':
                            aVal = a.feature.toLowerCase();
                            bVal = b.feature.toLowerCase();
                            break;
                        case 'status':
                            aVal = a.status;
                            bVal = b.status;
                            break;
                        case 'usage':
                            aVal = a.count;
                            bVal = b.count;
                            break;
                        case 'browser':
                            aVal = this.getBrowserSupportScore(a.browserSupport);
                            bVal = this.getBrowserSupportScore(b.browserSupport);
                            break;
                        default:
                            aVal = a.feature.toLowerCase();
                            bVal = b.feature.toLowerCase();
                    }
                    
                    if (aVal < bVal) return this.sortDirection === 'asc' ? -1 : 1;
                    if (aVal > bVal) return this.sortDirection === 'asc' ? 1 : -1;
                    return 0;
                });
            }

            getBrowserSupportScore(browserSupport) {
                if (!browserSupport) return 0;
                const scores = Object.values(browserSupport);
                return scores.reduce((sum, score) => sum + score, 0) / scores.length;
            }

            updateSortIndicators() {
                document.querySelectorAll('.sort-indicator').forEach(indicator => {
                    indicator.textContent = '‚Üï';
                });
                
                const currentTh = document.querySelector(`th[data-sort="${this.sortColumn}"] .sort-indicator`);
                if (currentTh) {
                    currentTh.textContent = this.sortDirection === 'asc' ? '‚Üë' : '‚Üì';
                }
            }

            render() {
                this.hideLoading();
                this.renderSummary();
                this.renderCharts();
                this.renderTable();
                this.renderRecommendations();
                this.updateMetadata();
            }

            renderSummary() {
                const summary = this.data.summary;
                
                document.getElementById('baselineCount').textContent = summary.baselineFeatures || 0;
                document.getElementById('riskyCount').textContent = summary.riskyFeatures || 0;
                document.getElementById('unknownCount').textContent = summary.unknownFeatures || 0;
                document.getElementById('totalCount').textContent = summary.totalFeatures || 0;
                document.getElementById('compatibilityScore').textContent = `${summary.compatibilityScore || 0}%`;
                document.getElementById('performanceScore').textContent = `${summary.performanceScore || 0}%`;
            }

            renderCharts() {
                this.renderStatusChart();
                this.renderBrowserChart();
                this.renderFileTypeChart();
                this.renderCategoryChart();
            }

            renderStatusChart() {
                const container = document.getElementById('statusChart');
                const data = this.data.summary.byStatus;
                const colors = {
                    baseline: '#10b981',
                    risky: '#f59e0b',
                    unknown: '#6b7280',
                    critical: '#dc2626'
                };
                
                this.createBarChart(container, data, colors);
            }

            renderBrowserChart() {
                const container = document.getElementById('browserChart');
                const data = this.data.summary.browserSupport;
                const colors = {
                    Chrome: '#4285f4',
                    Firefox: '#ff9500',
                    Safari: '#007aff',
                    Edge: '#0078d4'
                };
                
                this.createBarChart(container, data, colors);
            }

            renderFileTypeChart() {
                const container = document.getElementById('fileTypeChart');
                const data = this.data.summary.byFileType;
                const colors = {
                    '.html': '#e34c26',
                    '.css': '#1572b6',
                    '.js': '#f7df1e',
                    '.ts': '#3178c6'
                };
                
                this.createBarChart(container, data, colors);
            }

            renderCategoryChart() {
                const container = document.getElementById('categoryChart');
                const data = this.data.summary.byCategory;
                const colors = {
                    'CSS': '#1572b6',
                    'JavaScript': '#f7df1e',
                    'HTML': '#e34c26',
                    'Web APIs': '#61dafb'
                };
                
                this.createBarChart(container, data, colors);
            }

            createBarChart(container, data, colors) {
                container.innerHTML = '';
                
                const maxValue = Math.max(...Object.values(data));
                
                Object.entries(data).forEach(([key, value]) => {
                    const barItem = document.createElement('div');
                    barItem.className = 'bar-item';
                    
                    const label = document.createElement('div');
                    label.className = 'bar-label';
                    label.textContent = key;
                    
                    const track = document.createElement('div');
                    track.className = 'bar-track';
                    
                    const fill = document.createElement('div');
                    fill.className = 'bar-fill';
                    fill.style.width = `${(value / maxValue) * 100}%`;
                    fill.style.background = colors[key] || '#667eea';
                    
                    const valueLabel = document.createElement('div');
                    valueLabel.className = 'bar-value';
                    valueLabel.textContent = value;
                    
                    track.appendChild(fill);
                    track.appendChild(valueLabel);
                    barItem.appendChild(label);
                    barItem.appendChild(track);
                    container.appendChild(barItem);
                });
            }

            renderTable() {
                const tbody = document.getElementById('featuresTableBody');
                tbody.innerHTML = '';
                
                this.filteredData.forEach(item => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td class="feature-name">${item.feature}</td>
                        <td><span class="status-badge status-${item.status}">${item.status}</span></td>
                        <td class="usage-count">${item.count}</td>
                        <td>${this.renderBrowserSupport(item.browserSupport)}</td>
                        <td class="files-list">${this.renderFilesList(item.files)}</td>
                        <td>${this.renderTableRecommendations(item.recommendations)}</td>
                    `;
                    
                    tbody.appendChild(row);
                });
            }

            renderBrowserSupport(browserSupport) {
                if (!browserSupport) return '<span style="color: #999;">N/A</span>';
                
                const browsers = [
                    { name: 'Chrome', key: 'chrome', color: '#4285f4' },
                    { name: 'Firefox', key: 'firefox', color: '#ff9500' },
                    { name: 'Safari', key: 'safari', color: '#007aff' },
                    { name: 'Edge', key: 'edge', color: '#0078d4' }
                ];
                
                return browsers.map(browser => {
                    const version = browserSupport[browser.key];
                    if (!version) return '';
                    return `<div class="browser-icon browser-${browser.key}" title="${browser.name} ${version}+">${version}</div>`;
                }).join('');
            }

            renderFilesList(files) {
                if (!files || files.length === 0) return '<span style="color: #999;">No files</span>';
                
                return files.slice(0, 3).map(file => 
                    `<div class="file-item" title="${file}">${file}</div>`
                ).join('') + (files.length > 3 ? `<div class="file-item">+${files.length - 3} more</div>` : '');
            }

            renderTableRecommendations(recommendations) {
                if (!recommendations || recommendations.length === 0) return '<span style="color: #999;">No recommendations</span>';
                
                // Handle both string array and object array formats
                const recList = Array.isArray(recommendations) ? recommendations : [];
                if (recList.length === 0) return '<span style="color: #999;">No recommendations</span>';
                
                return recList.slice(0, 2).map(rec => {
                    const text = typeof rec === 'string' ? rec : rec.text || rec.message || rec.description || 'Recommendation';
                    return `<div style="font-size: 0.8rem; color: #4b5563; margin: 2px 0;">‚Ä¢ ${text}</div>`;
                }).join('') + (recList.length > 2 ? `<div style="font-size: 0.8rem; color: #999;">+${recList.length - 2} more</div>` : '');
            }

            renderRecommendations() {
                const container = document.getElementById('recommendationsList');
                const recommendations = this.generateRecommendations();
                
                container.innerHTML = recommendations.map(rec => `
                    <div class="recommendation-item">
                        <div class="recommendation-title">${rec.title}</div>
                        <div class="recommendation-description">${rec.description}</div>
                        <div class="recommendation-actions">
                            <h4>Recommended Actions:</h4>
                            <ul>
                                ${rec.actions.map(action => `<li>${action}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `).join('');
            }

            generateRecommendations() {
                const summary = this.data.summary;
                const recommendations = [];
                
                if (summary.riskyFeatures > 0) {
                    recommendations.push({
                        title: 'üö® Address Risky Features',
                        description: `You have ${summary.riskyFeatures} risky features that may cause compatibility issues.`,
                        actions: [
                            'Review each risky feature and its browser support',
                            'Add polyfills for unsupported browsers',
                            'Consider alternative implementations',
                            'Test thoroughly across target browsers'
                        ]
                    });
                }
                
                if (summary.unknownFeatures > 0) {
                    recommendations.push({
                        title: '‚ùì Research Unknown Features',
                        description: `You have ${summary.unknownFeatures} features with unknown compatibility status.`,
                        actions: [
                            'Research browser support for each feature',
                            'Check MDN documentation for compatibility data',
                            'Test in target browsers',
                            'Consider removing or replacing if unsupported'
                        ]
                    });
                }
                
                if (summary.compatibilityScore < 80) {
                    recommendations.push({
                        title: 'üìà Improve Compatibility Score',
                        description: `Your compatibility score is ${summary.compatibilityScore}%. Aim for 80%+ for better browser support.`,
                        actions: [
                            'Focus on fixing risky and unknown features',
                            'Add fallbacks for modern features',
                            'Use progressive enhancement techniques',
                            'Regularly test across different browsers'
                        ]
                    });
                }
                
                if (summary.performanceScore < 70) {
                    recommendations.push({
                        title: '‚ö° Optimize Performance',
                        description: `Your performance score is ${summary.performanceScore}%. Consider performance optimizations.`,
                        actions: [
                            'Minimize and compress assets',
                            'Use efficient CSS and JavaScript',
                            'Implement lazy loading',
                            'Optimize images and fonts'
                        ]
                    });
                }
                
                return recommendations;
            }

            updateMetadata() {
                const now = new Date();
                document.getElementById('generatedDate').textContent = now.toLocaleDateString();
                document.getElementById('footerDate').textContent = now.toLocaleString();
                document.getElementById('toolVersion').textContent = this.data.version || '2.3.0';
                document.getElementById('analysisDuration').textContent = this.data.summary.analysisDuration || 'N/A';
                document.getElementById('filesAnalyzed').textContent = this.data.summary.totalFiles || 0;
            }

            showLoading() {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('content').style.display = 'none';
            }

            hideLoading() {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';
            }

            showError(error) {
                document.getElementById('loading').innerHTML = `
                    <div class="error">
                        <h3>Error Loading Report</h3>
                        <p>${error.message}</p>
                        <p>Please check the console for more details.</p>
                    </div>
                `;
            }
        }

        // Initialize the enhanced report
        new BaselineReport();
    </script>
</body>
</html>
